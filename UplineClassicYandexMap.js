!function(){function o(o){const t=o.toLowerCase();return"blue"===t?"blue":"darkblue"===t?"darkBlue":"lightblue"===t?"lightBlue":"yellow"===t?"yellow":"green"===t?"green":"darkgreen"===t?"darkGreen":"olive"===t?"olive":"brown"===t?"brown":"red"===t?"red":"orange"===t?"orange":"darkorange"===t?"darkOrange":"pink"===t?"pink":"gray"===t?"gray":"night"===t?"night":"black"===t?"black":"violet"===t?"violet":"blue"}function t(o){const t=o.toLowerCase();return"airport"===t?"Airport":"attention"===t?"Attention":"auto"===t?"Auto":"bar"===t?"Bar":"barber"===t?"Barber":"beach"===t?"Beach":"bicycle"===t?"Bicycle":"bicycle2"===t?"Bicycle2":"book"===t?"Book":"carwash"===t?"CarWash":"christian"===t?"Christian":"cinema"===t?"Cinema":"circus"===t?"Circus":"court"===t?"Court":"delivery"===t?"Delivery":"discount"===t?"Discount":"dog"===t?"Dog":"education"===t?"Education":"entertainmentcenter"===t?"EntertainmentCenter":"factory"===t?"Factory":"family"===t?"Family":"fashion"===t?"Fashion":"food"===t?"Food":"fuelstation"===t?"FuelStation":"garden"===t?"Garden":"government"===t?"Government":"heart"===t?"Heart":"home"===t?"Home":"hotel"===t?"Hotel":"hydro"===t?"Hydro":"info"===t?"Info":"laundry"===t?"Laundry":"leisure"===t?"Leisure":"masstransit"===t?"MassTransit":"medical"===t?"Medical":"money"===t?"Money":"mountain"===t?"Mountain":"nightclub"===t?"NightClub":"observation"===t?"Observation":"park"===t?"Park":"parking"===t?"Parking":"person"===t?"Person":"pocket"===t?"Pocket":"pool"===t?"Pool":"post"===t?"Post":"railway"===t?"Railway":"rapidtransit"===t?"RapidTransit":"repairshop"===t?"RepairShop":"run"===t?"Run":"science"===t?"Science":"shopping"===t?"Shopping":"souvenirs"===t?"Souvenirs":"sport"===t?"Sport":"star"===t?"Star":"theater"===t?"Theater":"toilet"===t?"Toilet":"underpass"===t?"Underpass":"vegetation"===t?"Vegetation":"video"===t?"Video":"waste"===t?"Waste":"waterpark"===t?"WaterPark":"waterway"===t?"Waterway":"worship"===t?"Worship":"zoo"===t?"Zoo":""}function n(o="",t="",n="",e=!1){return`islands#${o}${t}${e?"Circle":""}${n}Icon`}function e(e){const i={};var r,l,c;return e.set_point_options&&(i.pointColor=o(e.point_options_color),"circle"===e.point_options_type&&(i.circle=!0),"dot"===e.point_options_kind&&(i.pointType="Dot"),"num"===e.point_options_kind&&(i.pointType=""),"text"===e.point_options_kind&&(i.pointType="Stretchy",i.circle=!1,i.pointText=e.point_options_text_default),"icon"===e.point_options_kind&&(i.pointIcon=t(e.point_options_icon_item)),i.pointPreset=n(i.pointColor,i.pointIcon,i.pointType,i.circle)),e.clusterize&&(i.clusterize={},i.clusterize.clusterize=e.clusterize,i.clusterize.clusterDisableClickZoom=e.cluster_disable_click_zoom,i.clusterize.clusterHasBalloon=e.cluster_has_balloon,e.clusterize&&(i.clusterize.preset=(r=e.cluster_options_color,`islands#${(l=e.cluster_is_invert)?"inverted":""}${l?(c=o(r.toLowerCase())).charAt(0).toUpperCase()+c.slice(1):o(r.toLowerCase())}ClusterIcons`),i.clusterize.clusterBalloonContentLayout=function(o){return"balloon_two_columns"===o?"cluster#balloonTwoColumns":"balloon_accordion"===o?"cluster#balloonAccordion":"balloon_carousel"===o?"cluster#balloonCarousel":void 0}(e.cluster_balloon_content_layout))),e.change_controls&&(i.controls=[],e.control_zoom_control&&i.controls.push("zoomControl"),e.control_search_control&&i.controls.push("searchControl"),e.control_type_selector&&i.controls.push("typeSelector"),e.control_fullscreen_control&&i.controls.push("fullscreenControl"),e.control_route_button_control&&i.controls.push("routeButtonControl")),i}function i(o){const t=document.querySelector(".upym__list"),n=document.querySelector(".upym__template").innerHTML;t.innerHTML="",o.forEach(function(o){const e=function(o,t){return{f1:o[t.f1],f2:o[t.f2],f3:o[t.f3],f4:o[t.f4],f5:o[t.f5],f6:o[t.f6],f7:o[t.f7],f8:o[t.f8]}}(o,params),i=(r=e,n.replace(/{{f\d}}/gi,o=>{const t=o.slice(2,o.length-2);return r[t]}));var r;t.innerHTML+=i})}window.crUplineYandexMap=function(r,l,c){const s=e(r),a=function(o){const t={};return o.latitude&&(t.lat=o.latitude),o.longitude&&(t.lon=o.longitude),o.id&&(t.id=o.id),o.set_point_options&&(o.point_options_color_field&&(t.color=o.point_options_color_field),"num"===o.point_options_kind&&o.point_options_number_field&&(t.number=o.point_options_number_field),"icon"===o.point_options_kind&&o.point_options_icon_field&&"field"===o.point_options_icon_type&&(t.icon=o.point_options_icon_field),"text"===o.point_options_kind&&o.point_options_text_field&&(t.text=o.point_options_text_field)),o.cluster_caption&&(t.clusterCaption=o.cluster_caption),o.icon_caption&&(t.iconCaption=o.icon_caption),o.balloon_content_header&&(t.balloonContentHeader=o.balloon_content_header),o.balloon_content_body&&(t.balloonContentBody=o.balloon_content_body),o.balloon_content_footer&&(t.balloonContentFooter=o.balloon_content_footer),o.set_cluster_options,t}(r),u=function(e,i,r){const l={type:"FeatureCollection",features:e.map(function(e,l){const c=i.pointText,s=i.pointColor,a=i.pointIcon,u=i.circle,p=i.pointType,_=e[r.lat],d=e[r.lon],b=e[r.id],f=e[r.text]||null,y=e[r.number]||null,C=f||y||c,h=e[r.color]?o(e[r.color]):s,g=e[r.icon]?t(e[r.icon]):a,m={type:"Feature"};b&&(m.id=b),_&&d&&(m.geometry={type:"Point",coordinates:[_,d]});const k={};return C&&(k.iconContent=C),r.balloonContent&&(k.balloonContent=e[r.balloonContent]),r.clusterCaption&&(k.clusterCaption=e[r.clusterCaption]),r.balloonContentHeader&&(k.balloonContentHeader=e[r.balloonContentHeader]),r.balloonContentBody&&(k.balloonContentBody=e[r.balloonContentBody]),r.balloonContentFooter&&(k.balloonContentFooter=e[r.balloonContentFooter]),m.properties=k,m.options={preset:n(h,g,p,u),openBalloonOnClick:!1},m})};return JSON.stringify(l)}(l.rows,s,a),p=l.rows[0][r.latitude]||null,_=l.rows[0][r.longitude]||null,d={center:p&&_?[p,_]:[55.831903,37.411961],zoom:15};s.controls&&(d.controls=s.controls),console.log(d);const b=new ymaps.Map(c,d);let f=new ymaps.ObjectManager(s.clusterize);f.add(u),b.geoObjects.add(f),b.setBounds(f.getBounds()),r.show_list&&(f.clusters.events.add(["click"],function(o){const t=f.clusters.getById(o.get("objectId")).properties.geoObjects.map(function(o,t){return o.id});i(l.rows.filter(o=>t.includes(o[a.id])))}),f.objects.events.add(["click"],function(o){const t=o.get("objectId");i(l.rows.filter(o=>t===o[a.id]))}))}}();